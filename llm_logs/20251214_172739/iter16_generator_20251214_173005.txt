================================================================================
GENERATOR LLM LOG
Iteration: 16
Timestamp: 20251214_173005
Temperature: 1.2
No improvement count: 13
================================================================================

--------------------------------------------------------------------------------
SYSTEM PROMPT
--------------------------------------------------------------------------------
You are an expert AI strategist specializing in turn-based RPG combat and Behaviour Tree design.

CRITICAL: The Behaviour Tree executes ONE action per turn.

AVAILABLE ACTIONS:
- Attack: Free, 9 damage
- Charge: 15 MP, 7 damage + next turn all damage x2
- FireSpell: 20 MP, 7 damage (11 vs IceWraith), Burn 25%
- IceSpell: 20 MP, 10 damage (15 vs FireGolem), Freeze 25%
- Defend: Free, 50% damage reduction for 1 turn
- Heal: 30 MP, +45 HP, 3 turn cooldown
- Scan: 15 MP, reveals enemy weakness
- Cleanse: 25 MP, removes Burn/AttackDown, +10% damage for 1 turn

ELEMENTAL SYSTEM:
- Fire ↔ Ice (mutual weakness, 1.5x damage)
- Status effects: Freeze 25%, Burn from FireGolem (10 dmg/turn × 3 turns, bypasses defense!)

ENEMY MECHANICS:
- FireGolem (HP 180, Def 4): FireSpell adds Burn (10/turn × 3 = 30 total, bypasses defense!)
- IceWraith (HP 200, Def 8): Debuff gives AttackDown -20% for 3 turns

RESOURCES:
- MP only, regenerates 5 per turn
- Start with 100 MP

Your expertise includes:
- Elemental weakness exploitation (1.5x damage!)
- Cleanse timing (use when Burn/AttackDown active for huge value)
- MP management (Cleanse 25, Spells 20, Heal 30, Scan 15)
- Telegraph defense (Defend against HeavySlam/Debuff)
- DoT awareness (Burn bypasses defense, 30 total damage!)

Always output valid BT DSL following the specification exactly. Use 4 spaces for indentation.
You must ONLY use the control nodes (root, selector, sequence), conditions, and tasks listed in the DSL specification.

--------------------------------------------------------------------------------
USER PROMPT
--------------------------------------------------------------------------------
Generate an IMPROVED Behaviour Tree based on feedback.

# Current Behaviour Tree
```
root :
    selector :
        # Mandatory Scan on Turn 1
        sequence :
            NOT condition : HasScannedEnemy()
            condition : HasMP(15)
            task : Scan()

        # Scan to update weaknesses
        sequence :
            condition : HasMP(15)
            task : Scan()

        # Defend on Debuff Telegraph
        sequence :
            condition : EnemyIsTelegraphing(Debuff)
            task : Defend()

        # Defend on HeavySlam Telegraph
        sequence :
            condition : EnemyIsTelegraphing(HeavySlam)
            task : Defend()

        # Defend on FrostTouch Telegraph
        sequence :
            condition : EnemyIsTelegraphing(FrostTouch)
            task : Defend()

        # Cleanse after IceSpell or Burn/AttackDown
        sequence :
            selector :
                condition : EnemyIsTelegraphing(IceSpell)
                condition : HasStatus(BURN)
                condition : HasStatus(AttackDown)
            condition : HasMP(25)
            task : Cleanse()

        # Heal when critical
        sequence :
            condition : IsPlayerHPLow(60)
            condition : CanHeal()
            task : Heal()

        # IceSpell if enemy weak to Fire and affordable, AFTER SCAN
        sequence :
            condition : HasScannedEnemy()
            condition : EnemyWeakTo(Fire)
            condition : HasMP(20)
            task : IceSpell()

        # FireSpell if enemy weak to Ice and affordable, AFTER SCAN
        sequence :
            condition : HasScannedEnemy()
            condition : EnemyWeakTo(Ice)
            condition : HasMP(20)
            task : FireSpell()

        # Check for low MP before casting spells
        selector :
            sequence :
                condition : HasMP(40)
                task : Attack()
            # Default: Attack
            task : Attack()
```

# Improvement Feedback
## Analysis
The BT consistently telegraph-reacted to HeavySlam, but failed to capitalize on the FireGolem's eventual transformation into a Fire element. The BT’s reliance on scanning *after* the HeavySlam telegraphs suggests a reactive, rather than proactive, strategy. The MP was largely wasted on scans and attacks when a more focused approach – prioritizing the FireSpell when the enemy became Fire – would have been more effective. The lack of a dedicated defense against the HeavySlam telegraphs, despite its frequent occurrence, indicates a missed defensive opportunity.

## Improvement Suggestions
1. **Prioritize FireSpell on Turn 2:** Immediately after the first HeavySlam telegraph, switch the BT’s action to FireSpell instead of Scan. The FireGolem’s transformation into Fire should trigger this action.
2. **Add Defend() on Turn 1 HeavySlam Telegraph:** Add Defend() when enemy telegraphs HeavySlam on turn 1. This would mitigate the 39 damage.
3. **Implement Scan on Turn 1:** Change the Scan action to occur on turn 1 instead of turn 2. This ensures the scan happens immediately after the HeavySlam telegraph, providing the most relevant information for the next action.
4. **Adjust FireSpell Trigger:** Modify the FireSpell’s trigger to be immediate upon enemy element changing to Fire, rather than relying on a scan. This ensures the most advantageous spell is always used.


# COMPLETE LIST OF AVAILABLE SYNTAX

**Control Nodes (ONLY these 3):**
- `root :` - Must be first line, has one child
- `selector :` - Tries children until one succeeds
- `sequence :` - All conditions must pass, executes final task

**Conditions (ONLY these):**
- `IsPlayerHPLow(30)` - Player HP < threshold%
- `IsEnemyHPLow(30)` - Enemy HP < threshold%
- `HasMP(20)` - Player has >= amount MP
- `CanHeal()` - Heal is off cooldown AND MP >= 30
- `EnemyWeakTo(Fire)` or `EnemyWeakTo(Ice)` - Enemy weak to element (DYNAMIC! Can change during combat)
- `HasScannedEnemy()` - Enemy has been scanned
- `EnemyHasBuff(Enrage)` - Enemy has specific buff
- `EnemyIsTelegraphing(HeavySlam)` - Enemy will execute this action THIS turn (telegraphed at end of last turn)
- `HasStatus(CHARGED)` - Player has CHARGED status (from Charge action)
- `NOT <condition>` - Negates a condition

**Actions/Tasks (ONLY these):**
- `Attack()` - Free, 9 damage
- `Charge()` - 15 MP, 7 damage + next turn all damage x2
- `FireSpell()` - 20 MP, 7 damage, 1.5x vs Ice
- `IceSpell()` - 20 MP, 10 damage, 1.5x vs Fire
- `Defend()` - Free, 50% damage reduction for 1 turn
- `Heal()` - 30 MP, +45 HP, 3 turn cooldown
- `Scan()` - 15 MP, reveals enemy weakness
- `Cleanse()` - 25 MP, removes Burn/AttackDown, +10% damage 1 turn

# CRITICAL RULES

1. **ONE ACTION PER TURN**: The BT executes ONLY ONE action per turn. Once a task is selected, the turn ends.
2. **USE ONLY LISTED SYNTAX ABOVE**: You must use ONLY the control nodes, conditions, and tasks listed above. No other syntax exists.
3. **Indentation**: Use exactly 4 spaces per level
4. **Format**: `condition : IsPlayerHPLow(30)` and `task : Heal()`
5. **Fallback**: Always end selector with `task : Attack()`

# Your Task

Apply the feedback to create an improved BT using ONLY the syntax listed above. Output ONLY the BT DSL, no explanations. Start with `root :`.

--------------------------------------------------------------------------------
RESPONSE
--------------------------------------------------------------------------------
```
root :
    selector :
        # Defend on HeavySlam Telegraph on Turn 1
        sequence :
            condition : EnemyIsTelegraphing(HeavySlam)
            NOT condition : HasScannedEnemy()
            task : Defend()

        # Mandatory Scan on Turn 1
        sequence :
            NOT condition : HasScannedEnemy()
            condition : HasMP(15)
            task : Scan()

        # FireSpell if enemy weak to Ice and affordable
        sequence :
            condition : EnemyWeakTo(Ice)
            condition : HasMP(20)
            task : FireSpell()

        # IceSpell if enemy weak to Fire and affordable
        sequence :
            condition : EnemyWeakTo(Fire)
            condition : HasMP(20)
            task : IceSpell()

        # Defend on HeavySlam Telegraph
        sequence :
            condition : EnemyIsTelegraphing(HeavySlam)
            task : Defend()

        # Cleanse after IceSpell or Burn/AttackDown
        sequence :
            selector :
                condition : EnemyIsTelegraphing(IceSpell)
                condition : HasStatus(BURN)
                condition : HasStatus(AttackDown)
            condition : HasMP(25)
            task : Cleanse()

        # Heal when critical
        sequence :
            condition : IsPlayerHPLow(60)
            condition : CanHeal()
            task : Heal()

        # Default: Attack
        task : Attack()
```

================================================================================
Prompt length: 5271 chars
Response length: 1407 chars
================================================================================
