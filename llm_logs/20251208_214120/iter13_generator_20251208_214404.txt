================================================================================
GENERATOR LLM LOG
Iteration: 13
Timestamp: 20251208_214404
Temperature: 0.7999999999999999
No improvement count: 3
================================================================================

--------------------------------------------------------------------------------
SYSTEM PROMPT
--------------------------------------------------------------------------------
You are an expert AI strategist specializing in turn-based RPG combat and Behaviour Tree design.

CRITICAL: The Behaviour Tree executes ONLY ONE action per turn. Once an action is selected, the turn ends immediately.

Your expertise includes:
- Elemental weakness exploitation (Fire/Ice/Lightning rock-paper-scissors)
- Resource management (TP/MP optimization)
- Status effect timing and usage
- Enemy pattern recognition and adaptation
- Defensive vs aggressive strategy selection

Always output valid BT DSL following the specification exactly. Use 4 spaces for indentation.
You must ONLY use the control nodes (root, selector, sequence), conditions, and tasks listed in the DSL specification.

--------------------------------------------------------------------------------
USER PROMPT
--------------------------------------------------------------------------------
Generate an IMPROVED Behaviour Tree based on feedback.

# Current Behaviour Tree
```
root :
    selector :
        # Ice Exploit Immediately After Scan
        sequence :
            condition : HasScannedEnemy()
            condition : EnemyWeakTo(Ice)
            condition : HasMP(10)
            task : IceSpell()

        # Emergency Defend
        sequence :
            condition : IsPlayerHPLow(30)
            condition : EnemyIsTelegraphing(HeavySlam)
            task : Defend()

        # Aggressive Heal
        sequence :
            condition : IsPlayerHPLow(30)
            condition : EnemyIsTelegraphing(HeavySlam)
            condition : CanHeal()
            task : Heal()

        # Power Strike if TP and High Enemy HP
        sequence :
            condition : HasTP(30)
            condition : IsEnemyHPLow(70)
            task : PowerStrike()

        # Fire Exploit
        sequence :
            condition : HasScannedEnemy()
            condition : EnemyWeakTo(Fire)
            condition : HasMP(15)
            task : FireSpell()

        # Lightning Exploit
        sequence :
            condition : HasScannedEnemy()
            condition : EnemyWeakTo(Lightning)
            condition : HasMP(20)
            condition : HasTP(20)
            task : LightningSpell()

        # Scan on Turn 1
        sequence :
            condition : IsTurnEarly(1)
            task : Scan()

        # Default: Attack
        task : Attack()
```

# Improvement Feedback
## Analysis
The combat consistently resulted in defeat against the FireGolem, primarily due to a rigid adherence to the BT's pre-defined sequences without adapting to the enemy's telegraphs and elemental weaknesses. The BT prioritized immediate Ice spellcasting after scanning, even when the FireGolem was telegraphing a HeavySlam attack. This meant the player was consistently punished for not defending. The MP was also inefficiently spent on spells when a simple defend would have been more effective. The LightningSpell's TP requirement alongside the scan condition was also a significant bottleneck.

## Improvement Suggestions
1.  **Prioritize Defense Against Telegraphs:** Modify the “Emergency Defend” sequence to trigger *immediately* upon detecting a HeavySlam telegraph, regardless of MP cost.  This should be a higher priority than the Ice spellcasting sequence.  The trigger condition should be broadened to include any aggressive telegraph, not just HeavySlam.

2.  **Adaptive Scanning:**  Instead of scanning on turn 1, implement a conditional scan. The scan should only occur if the enemy is *not* telegraphing a heavy attack. This prevents the player from wasting MP on a scan when a defensive action is more critical.

3.  **Dynamic Spell Selection:**  Introduce a secondary condition to the IceSpell sequence: "IsEnemyWeakTo(Ice) AND EnemyIsNotTelegraphing". This allows the BT to prioritize Ice when appropriate, but doesn't force it when the enemy is actively attacking.

4.  **Heal Threshold Adjustment:** Increase the heal threshold from 30% to 40%. This will allow for more proactive healing, preventing the player from reaching critical health and being forced into defensive postures.

5. **TP/MP Cost Reduction on Lightning Spell:** Reduce the TP cost of the LightningSpell from 20 to 10. This will make the spell more viable and allow the player to utilize it more frequently.

# COMPLETE LIST OF AVAILABLE SYNTAX

**Control Nodes (ONLY these 3):**
- `root :` - Must be first line, has one child
- `selector :` - Tries children until one succeeds
- `sequence :` - All conditions must pass, executes final task

**Conditions (ONLY these):**
- `IsPlayerHPLow(30)` - Player HP < threshold%
- `IsEnemyHPLow(30)` - Enemy HP < threshold%
- `HasTP(30)` - Player has >= amount TP
- `HasMP(20)` - Player has >= amount MP
- `CanHeal()` - Heal is off cooldown AND MP >= 30
- `EnemyWeakTo(Fire)` or `EnemyWeakTo(Ice)` or `EnemyWeakTo(Lightning)` - Enemy weak to element
- `HasScannedEnemy()` - Enemy has been scanned
- `EnemyHasBuff(Enrage)` - Enemy has specific buff
- `EnemyIsTelegraphing(HeavySlam)` - Enemy telegraphing attack
- `IsTurnEarly(2)` - Turn count <= threshold

**Actions/Tasks (ONLY these):**
- `Attack()` - 0 TP, 15-18 damage, gains +15 TP
- `PowerStrike()` - 30 TP, 40-50 damage
- `FireSpell()` - 20 MP, 25-30 Fire damage, 1.5x vs Ice
- `IceSpell()` - 20 MP, 25-30 Ice damage, 1.5x vs Lightning
- `LightningSpell()` - 20 MP, 25-30 Lightning damage, 1.5x vs Fire
- `Defend()` - 0 TP, -50% damage for 1 turn, gains +20 TP
- `Heal()` - 30 MP, +45 HP, 3 turn cooldown
- `Scan()` - 15 MP, reveals enemy weakness

# CRITICAL RULES

1. **ONE ACTION PER TURN**: The BT executes ONLY ONE action per turn. Once a task is selected, the turn ends.
2. **USE ONLY LISTED SYNTAX ABOVE**: You must use ONLY the control nodes, conditions, and tasks listed above. No other syntax exists.
3. **Indentation**: Use exactly 4 spaces per level
4. **Format**: `condition : IsPlayerHPLow(30)` and `task : Heal()`
5. **Fallback**: Always end selector with `task : Attack()`

# Your Task

Apply the feedback to create an improved BT using ONLY the syntax listed above. Output ONLY the BT DSL, no explanations. Start with `root :`.

--------------------------------------------------------------------------------
RESPONSE
--------------------------------------------------------------------------------
```
root :
    selector :
        # Emergency Defend Against Any Aggressive Telegraph
        sequence :
            condition : EnemyIsTelegraphing(HeavySlam)
            task : Defend()

        # Ice Exploit Immediately After Scan, If Not Telegraphing
        sequence :
            condition : HasScannedEnemy()
            condition : EnemyWeakTo(Ice)
            condition : EnemyIsTelegraphing(HeavySlam)
            task : IceSpell()

        # Aggressive Heal
        sequence :
            condition : IsPlayerHPLow(40)
            condition : CanHeal()
            task : Heal()

        # Power Strike if TP and High Enemy HP
        sequence :
            condition : HasTP(30)
            condition : IsEnemyHPLow(70)
            task : PowerStrike()

        # Fire Exploit
        sequence :
            condition : HasScannedEnemy()
            condition : EnemyWeakTo(Fire)
            condition : HasMP(20)
            task : FireSpell()

        # Lightning Exploit
        sequence :
            condition : HasScannedEnemy()
            condition : EnemyWeakTo(Lightning)
            condition : HasMP(20)
            condition : HasTP(10)
            task : LightningSpell()

        # Scan on Turn 1, if not telegraphing
        sequence :
            condition : IsTurnEarly(1)
            condition : EnemyIsTelegraphing(HeavySlam)
            task : Scan()

        # Default: Attack
        task : Attack()
```

================================================================================
Prompt length: 5227 chars
Response length: 1438 chars
================================================================================
