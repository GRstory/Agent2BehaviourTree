================================================================================
GENERATOR LLM LOG
Iteration: 1
Timestamp: 20251207_190313
Temperature: 0.7
No improvement count: 0
================================================================================

--------------------------------------------------------------------------------
SYSTEM PROMPT
--------------------------------------------------------------------------------
You are an expert AI strategist specializing in turn-based RPG combat and Behaviour Tree design.

CRITICAL: The Behaviour Tree executes ONLY ONE action per turn. Once an action is selected, the turn ends immediately.

Your expertise includes:
- Elemental weakness exploitation (Fire/Ice/Lightning rock-paper-scissors)
- Resource management (TP/MP optimization)
- Status effect timing and usage
- Enemy pattern recognition and adaptation
- Defensive vs aggressive strategy selection

Always output valid BT DSL following the specification exactly. Use 4 spaces for indentation.
You must ONLY use the control nodes (root, selector, sequence), conditions, and tasks listed in the DSL specification.

--------------------------------------------------------------------------------
USER PROMPT
--------------------------------------------------------------------------------
Generate an IMPROVED Behaviour Tree based on feedback.

# Current Behaviour Tree
```
root :
    selector :
        # Heal when critical
        sequence :
            condition : IsPlayerHPLow(50)
            condition : CanHeal()
            task : Heal()

        # Exploit weakness
        selector :
            sequence :
                condition : HasScannedEnemy()
                condition : EnemyWeakTo(Fire)
                condition : HasMP(20)
                task : FireSpell()
            sequence :
                condition : HasScannedEnemy()
                condition : EnemyWeakTo(Ice)
                condition : HasMP(20)
                task : IceSpell()
            sequence :
                condition : HasScannedEnemy()
                condition : EnemyWeakTo(Lightning)
                condition : HasMP(20)
                task : LightningSpell()

        # Defend when enemy is low
        sequence :
            condition : IsEnemyHPLow(75)
            task : Defend()

        # Scan for weakness
        sequence :
            condition : HasMP(15)
            condition : HasScannedEnemy()
            task : Attack()
        sequence :
            condition : HasMP(15)
            task : Scan()

        # Default: Attack
        task : Attack()
```

# Improvement Feedback
## Analysis
The combat repeatedly failed to capitalize on the FireGolem’s weakness to Ice, despite scanning it. The Heal task was triggered frequently, but never when it mattered most – the FireGolem’s health remained high. The MP expenditure on Fire and Lightning spells was inefficient, as they weren’t consistently used. The Defend task was triggered too late, after the enemy had already inflicted significant damage. The BT prioritizes scanning, which is good, but doesn’t effectively translate into damage output.

## Improvement Suggestions
1.  **Prioritize Ice Spell on Weakness Scan:** Modify the BT to immediately execute the IceSpell task when the FireGolem is scanned and revealed to be weak to Ice.  This should be the highest priority within the "HasScannedEnemy" sequence.

2.  **Conditional Heal Trigger:**  Adjust the Heal task's trigger condition. Instead of just ‘IsPlayerHPLow(50)’, make it ‘IsPlayerHPLow(20) AND EnemyHP > 70’ – meaning heal only when the player is low *and* the enemy is still significantly healthy.

3.  **Defend Trigger Adjustment:**  Move the Defend task trigger to ‘IsEnemyHPLow(50)’. This will allow for a more proactive defensive stance, preventing the FireGolem from reaching critical health before a counter-attack can be launched.

4.  **Introduce a 'Counter-Attack' Task:** Add a task to the ‘HasScannedEnemy’ sequences to attempt a basic attack when the enemy is scanned. This provides a more immediate response to the enemy's presence and prevents the BT from simply waiting for the next scan. This task should have a low MP cost.


# COMPLETE LIST OF AVAILABLE SYNTAX

**Control Nodes (ONLY these 3):**
- `root :` - Must be first line, has one child
- `selector :` - Tries children until one succeeds
- `sequence :` - All conditions must pass, executes final task

**Conditions (ONLY these):**
- `IsPlayerHPLow(30)` - Player HP < threshold%
- `IsEnemyHPLow(30)` - Enemy HP < threshold%
- `HasTP(30)` - Player has >= amount TP
- `HasMP(20)` - Player has >= amount MP
- `CanHeal()` - Heal is off cooldown AND MP >= 30
- `EnemyWeakTo(Fire)` or `EnemyWeakTo(Ice)` or `EnemyWeakTo(Lightning)` - Enemy weak to element
- `HasScannedEnemy()` - Enemy has been scanned
- `EnemyHasBuff(Enrage)` - Enemy has specific buff
- `EnemyIsTelegraphing(HeavySlam)` - Enemy telegraphing attack
- `IsTurnEarly(2)` - Turn count <= threshold

**Actions/Tasks (ONLY these):**
- `Attack()` - 0 TP, 15-18 damage, gains +15 TP
- `PowerStrike()` - 30 TP, 40-50 damage
- `FireSpell()` - 20 MP, 25-30 Fire damage, 1.5x vs Ice
- `IceSpell()` - 20 MP, 25-30 Ice damage, 1.5x vs Lightning
- `LightningSpell()` - 20 MP, 25-30 Lightning damage, 1.5x vs Fire
- `Defend()` - 0 TP, -50% damage for 1 turn, gains +20 TP
- `Heal()` - 30 MP, +45 HP, 3 turn cooldown
- `Scan()` - 15 MP, reveals enemy weakness

# CRITICAL RULES

1. **ONE ACTION PER TURN**: The BT executes ONLY ONE action per turn. Once a task is selected, the turn ends.
2. **USE ONLY LISTED SYNTAX ABOVE**: You must use ONLY the control nodes, conditions, and tasks listed above. No other syntax exists.
3. **Indentation**: Use exactly 4 spaces per level
4. **Format**: `condition : IsPlayerHPLow(30)` and `task : Heal()`
5. **Fallback**: Always end selector with `task : Attack()`

# Your Task

Apply the feedback to create an improved BT using ONLY the syntax listed above. Output ONLY the BT DSL, no explanations. Start with `root :`.

--------------------------------------------------------------------------------
RESPONSE
--------------------------------------------------------------------------------
```
root :
    selector :
        # Heal when critical and enemy is strong
        sequence :
            condition : IsPlayerHPLow(20)
            condition : IsEnemyHPLow(70)
            condition : CanHeal()
            task : Heal()

        # Exploit weakness
        selector :
            sequence :
                condition : HasScannedEnemy()
                condition : EnemyWeakTo(Ice)
                condition : HasMP(20)
                task : IceSpell()
            sequence :
                condition : HasScannedEnemy()
                condition : EnemyWeakTo(Fire)
                condition : HasMP(20)
                task : FireSpell()
            sequence :
                condition : HasScannedEnemy()
                condition : EnemyWeakTo(Lightning)
                condition : HasMP(20)
                task : LightningSpell()

        # Defend when enemy is dangerous
        sequence :
            condition : IsEnemyHPLow(50)
            task : Defend()

        # Scan for weakness, then counter-attack
        sequence :
            condition : HasMP(15)
            condition : HasScannedEnemy()
            task : Attack()
        sequence :
            condition : HasMP(15)
            task : Scan()

        # Default: Attack
        task : Attack()
```

================================================================================
Prompt length: 4725 chars
Response length: 1292 chars
================================================================================
