================================================================================
GENERATOR LLM LOG
Iteration: 6
Timestamp: 20251208_001710
Temperature: 0.7
No improvement count: 1
================================================================================

--------------------------------------------------------------------------------
SYSTEM PROMPT
--------------------------------------------------------------------------------
You are an expert AI strategist specializing in turn-based RPG combat and Behaviour Tree design.

CRITICAL: The Behaviour Tree executes ONLY ONE action per turn. Once an action is selected, the turn ends immediately.

Your expertise includes:
- Elemental weakness exploitation (Fire/Ice/Lightning rock-paper-scissors)
- Resource management (TP/MP optimization)
- Status effect timing and usage
- Enemy pattern recognition and adaptation
- Defensive vs aggressive strategy selection

Always output valid BT DSL following the specification exactly. Use 4 spaces for indentation.
You must ONLY use the control nodes (root, selector, sequence), conditions, and tasks listed in the DSL specification.

--------------------------------------------------------------------------------
USER PROMPT
--------------------------------------------------------------------------------
Generate an IMPROVED Behaviour Tree based on feedback.

# Current Behaviour Tree
```
root :
    selector :
        # Scan on Enemy Attack Telegraph
        sequence :
            condition : EnemyIsTelegraphing(HeavySlam)
            condition : HasMP(15)
            task : Scan()

        # Heal when critical, with cooldown
        sequence :
            condition : IsPlayerHPLow(30)
            condition : CanHeal()
            task : Heal()

        # Reactive Defend
        sequence :
            condition : IsPlayerHPLow(50)
            task : Defend()

        # Defend when Enemy attacks
        sequence :
            condition : EnemyIsTelegraphing(HeavySlam)
            task : Defend()

        # Exploit Weakness if Enemy HP is high
        sequence :
            condition : HasScannedEnemy()
            condition : EnemyWeakTo(Ice)
            condition : IsEnemyHPLow(80)
            condition : HasMP(30)
            task : IceSpell()

        # Scan with Cooldown
        sequence :
            condition : IsTurnEarly(2)
            condition : HasMP(15)
            task : Scan()

        # Default: Attack
        task : Attack()
```

# Improvement Feedback
## Analysis
The combat against the FireGolem highlighted several key issues with the current Behaviour Tree. The most significant problem was the overly cautious approach to exploiting the FireGolem's weakness to Ice. The BT consistently prioritized scanning and the IceSpell *only* when the enemy was at 80% HP, which was far too late.  The Heal action was triggered frequently but without sufficient HP reduction, and the Defend action was triggered reactively, often during the enemy's attack telegraph, essentially just delaying damage. The BT's reliance on scanning felt inefficient, and the turn-based nature of the combat allowed the FireGolem to build up significant damage before any impactful actions were taken. The lack of proactive damage dealing, combined with the reactive defensive actions, led to a slow, unsustainable loss.

## Improvement Suggestions
1.  **Prioritize IceSpell on Turn 1:**  Modify the IceSpell sequence to trigger on turn 1 *regardless* of enemy HP. This allows for immediate exploitation of the weakness, rather than waiting for a specific HP threshold.  This should be a higher priority task than scanning.

2.  **Increase Heal Threshold:** Adjust the heal threshold from 30% to 40%.  Waiting until 30% HP to heal is too late; the player should be healed more proactively to maintain a higher HP pool.

3.  **Introduce a "Damage Burst" Task:** Add a new task, "DamageBurst," that executes a high-damage attack (e.g., a powerful sword strike) when the FireGolem is telegraphing an attack. This would allow for more aggressive damage dealing and prevent the FireGolem from building up too much HP.  This task should have a higher priority than Scan.

4. **Reduce Scan Frequency:**  The "Scan" task is triggered too frequently (on turn 1 and 2).  Reduce the frequency to only on turn 1, or only when the player is at the start of their turn. This will reduce MP consumption without sacrificing critical information.


# COMPLETE LIST OF AVAILABLE SYNTAX

**Control Nodes (ONLY these 3):**
- `root :` - Must be first line, has one child
- `selector :` - Tries children until one succeeds
- `sequence :` - All conditions must pass, executes final task

**Conditions (ONLY these):**
- `IsPlayerHPLow(30)` - Player HP < threshold%
- `IsEnemyHPLow(30)` - Enemy HP < threshold%
- `HasTP(30)` - Player has >= amount TP
- `HasMP(20)` - Player has >= amount MP
- `CanHeal()` - Heal is off cooldown AND MP >= 30
- `EnemyWeakTo(Fire)` or `EnemyWeakTo(Ice)` or `EnemyWeakTo(Lightning)` - Enemy weak to element
- `HasScannedEnemy()` - Enemy has been scanned
- `EnemyHasBuff(Enrage)` - Enemy has specific buff
- `EnemyIsTelegraphing(HeavySlam)` - Enemy telegraphing attack
- `IsTurnEarly(2)` - Turn count <= threshold

**Actions/Tasks (ONLY these):**
- `Attack()` - 0 TP, 15-18 damage, gains +15 TP
- `PowerStrike()` - 30 TP, 40-50 damage
- `FireSpell()` - 20 MP, 25-30 Fire damage, 1.5x vs Ice
- `IceSpell()` - 20 MP, 25-30 Ice damage, 1.5x vs Lightning
- `LightningSpell()` - 20 MP, 25-30 Lightning damage, 1.5x vs Fire
- `Defend()` - 0 TP, -50% damage for 1 turn, gains +20 TP
- `Heal()` - 30 MP, +45 HP, 3 turn cooldown
- `Scan()` - 15 MP, reveals enemy weakness

# CRITICAL RULES

1. **ONE ACTION PER TURN**: The BT executes ONLY ONE action per turn. Once a task is selected, the turn ends.
2. **USE ONLY LISTED SYNTAX ABOVE**: You must use ONLY the control nodes, conditions, and tasks listed above. No other syntax exists.
3. **Indentation**: Use exactly 4 spaces per level
4. **Format**: `condition : IsPlayerHPLow(30)` and `task : Heal()`
5. **Fallback**: Always end selector with `task : Attack()`

# Your Task

Apply the feedback to create an improved BT using ONLY the syntax listed above. Output ONLY the BT DSL, no explanations. Start with `root :`.

--------------------------------------------------------------------------------
RESPONSE
--------------------------------------------------------------------------------
```
root :
    selector :
        # Turn 1 Ice Spell
        sequence :
            condition : IsTurnEarly(1)
            condition : EnemyWeakTo(Ice)
            condition : HasMP(20)
            task : IceSpell()

        # Damage Burst on telegraph
        sequence :
            condition : EnemyIsTelegraphing(HeavySlam)
            condition : HasTP(30)
            task : PowerStrike()

        # Heal when critical, with cooldown
        sequence :
            condition : IsPlayerHPLow(40)
            condition : CanHeal()
            task : Heal()

        # Reactive Defend
        sequence :
            condition : IsPlayerHPLow(50)
            task : Defend()

        # Exploit Weakness if Enemy HP is high
        sequence :
            condition : HasScannedEnemy()
            condition : EnemyWeakTo(Ice)
            condition : IsEnemyHPLow(80)
            condition : HasMP(20)
            task : IceSpell()

        # Scan on Turn 1
        sequence :
            condition : IsTurnEarly(1)
            condition : HasMP(15)
            task : Scan()

        # Defend when Enemy attacks
        sequence :
            condition : EnemyIsTelegraphing(HeavySlam)
            task : Defend()

        # Default: Attack
        task : Attack()
```

================================================================================
Prompt length: 4969 chars
Response length: 1268 chars
================================================================================
